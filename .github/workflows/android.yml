name: Android CI

on:
  push:
      branches: [ master, xulongnr-patch-1 ]
      tags: []
#       paths:
#         - 'app/src/*'

  schedule:
      - cron: 0 0 * * 5 # Every Friday

#  pull_request:
#    branches: [ master ]

jobs:
  
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - name: checkout submodule
      run: |
        git submodule sync --recursive
        git submodule update --init --recursive

    - name: docker
      run: |
         sudo chown -R 3434:3434 .
         docker run --rm -v ${PWD}:/home/circleci/src circleci/android:api-28-ndk bash -c "cd /home/circleci/src; \
            ./gradlew assembleDebug;
            ./gradlew assembleRelease"
         ls -l build/app/build/outputs/apk/{debug,release}

#    - name: Build with Gradle
#      run: ./gradlew assembleRelease
